name: üõ°Ô∏è Self-Healing CI/CD (Simple)

on:
  workflow_run:
    workflows:
      - "üß™ Test Workflow for Self-Healing"
    types:
      - completed

permissions:
  actions: write
  issues: write
  contents: read

jobs:
  test-trigger:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    
    steps:
      - name: Log Event
        run: |
          echo "Workflow Name: ${{ github.event.workflow_run.name }}"
          echo "Conclusion: ${{ github.event.workflow_run.conclusion }}"
          echo "Run ID: ${{ github.event.workflow_run.id }}"
          echo "Run URL: ${{ github.event.workflow_run.html_url }}"
      
      - name: Create Simple Issue
        env:
          GH_TOKEN: ${{ github.token }}
        run: |
          gh issue create \
            --repo "${{ github.repository }}" \
            --title "Test Self-Healing Trigger" \
            --body "Successfully detected failure in ${{ github.event.workflow_run.name }}" \
            --label "test,self-healing"
